Object subclass: #Address	instanceVariableNames: 'id streetName streetNumber town zipCode province'	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!!Address methodsFor: 'zip code' stamp: 'HernanWilkinson 10/28/2016 16:13'!zipCode	^zipCode! !!Address methodsFor: 'zip code' stamp: 'HernanWilkinson 10/28/2016 16:08'!zipCode: aZipCode 	zipCode := aZipCode! !!Address methodsFor: 'twon' stamp: 'HernanWilkinson 10/28/2016 16:12'!town	^town! !!Address methodsFor: 'twon' stamp: 'HernanWilkinson 10/28/2016 16:07'!town: aTown 	town := aTown! !!Address methodsFor: 'as yet unclassified' stamp: 'HernanWilkinson 11/1/2016 10:06'!isAt: aStreetName	^streetName = aStreetName ! !!Address methodsFor: 'province' stamp: 'HernanWilkinson 10/28/2016 16:11'!province	^province! !!Address methodsFor: 'province' stamp: 'HernanWilkinson 10/28/2016 16:08'!province: aProvince 	province := aProvince	! !!Address methodsFor: 'street' stamp: 'HernanWilkinson 10/28/2016 16:12'!streetName	^streetName ! !!Address methodsFor: 'street' stamp: 'HernanWilkinson 10/28/2016 13:27'!streetNumber: aStreetNumber 	streetNumber := aStreetNumber ! !!Address methodsFor: 'street' stamp: 'HernanWilkinson 10/28/2016 13:27'!streetName: aStreetName 	streetName := aStreetName ! !!Address methodsFor: 'street' stamp: 'HernanWilkinson 10/28/2016 16:12'!streetNumber	^streetNumber ! !TestCase subclass: #CustomerImportTest	instanceVariableNames: 'system'	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!!CustomerImportTest methodsFor: 'test data - address' stamp: 'HernanWilkinson 11/2/2016 10:45'!addressRecordWithMoreThanSixFieldsTestData		^ ReadStream on: self alwaysImportedCustomerRecord,'A,San Martin,3322,Olivos,1636,BsAs,y otra cosa'! !!CustomerImportTest methodsFor: 'test data - address' stamp: 'HernanWilkinson 11/1/2016 15:59'!addressWithoutCustomerTestData		^ ReadStream on: 'A,San Martin,3322,Olivos,1636,BsAs'! !!CustomerImportTest methodsFor: 'test data - address' stamp: 'HernanWilkinson 11/2/2016 10:45'!addressRecordWithLessThanSixFieldsTestData		^ ReadStream on: self alwaysImportedCustomerRecord,'A,San Martin,3322,Olivos,1636'! !!CustomerImportTest methodsFor: 'test data - address' stamp: 'HernanWilkinson 11/2/2016 10:45'!addressRecordStartingWithMoreThanOneATestData		^ ReadStream on: self alwaysImportedCustomerRecord,'AA,San Martin,3322,Olivos,1636,BsAs'! !!CustomerImportTest methodsFor: 'test data - customer' stamp: 'HernanWilkinson 11/2/2016 10:46'!alwaysImportedCustomerIdType	^ 'D'! !!CustomerImportTest methodsFor: 'test data - customer' stamp: 'HernanWilkinson 11/2/2016 10:47'!alwaysImportedCustomerIdNumber	^ '22333444'! !!CustomerImportTest methodsFor: 'test data - customer' stamp: 'HernanWilkinson 11/1/2016 17:48'!customerRecordStartingWithMoreThanOneCTestData		^ ReadStream on:'CC,Pepe,Sanchez,D,22333444'! !!CustomerImportTest methodsFor: 'test data - customer' stamp: 'HernanWilkinson 11/2/2016 10:50'!customerRecordWithLessThanFiveFieldsTestData		^ ReadStream on: 'C,Pepe,Sanchez,D'! !!CustomerImportTest methodsFor: 'test data - customer' stamp: 'HernanWilkinson 11/2/2016 10:53'!customerRecordWithMoreThanFiveFieldsTestData		^ ReadStream on: self alwaysImportedCustomerRecord,',x'! !!CustomerImportTest methodsFor: 'test data - customer' stamp: 'alavia 11/16/2017 19:38'!alwaysImportedCustomer	^ system		customerIdentifiedAs: self alwaysImportedCustomerIdType		numbered: self alwaysImportedCustomerIdNumber		ifNone: [ self fail ]! !!CustomerImportTest methodsFor: 'test data - customer' stamp: 'HernanWilkinson 11/2/2016 10:47'!alwaysImportedCustomerRecord	^ 'C,Pepe,Sanchez,', self alwaysImportedCustomerIdType, ',', self alwaysImportedCustomerIdNumber ! !!CustomerImportTest methodsFor: 'test data' stamp: 'HernanWilkinson 11/2/2016 10:46'!validTestData	^ ReadStream on: self alwaysImportedCustomerRecord,'A,San Martin,3322,Olivos,1636,BsAsA,Maipu,888,Florida,1122,Buenos AiresC,Juan,Perez,C,23-25666777-9A,Alem,1122,CABA,1001,CABA'! !!CustomerImportTest methodsFor: 'test data' stamp: 'HernanWilkinson 11/2/2016 15:52'!dataWithEmptyLine		^ ReadStream on: self alwaysImportedCustomerRecord,'A,San Martin,3322,Olivos,1636,BsAs'! !!CustomerImportTest methodsFor: 'asserting' stamp: 'RodrigoOscarKapobel 11/20/2017 14:23'!assertImportedCustomersSizeIsCorrect	self assert: system allCustomersSize equals: 2! !!CustomerImportTest methodsFor: 'asserting' stamp: 'alavia 11/16/2017 19:38'!assertPepeSanchezWasImportedCorrectly	| customer idType idNumber |	idType := 'D'.	idNumber := '22333444'.	customer := system		customerIdentifiedAs: idType		numbered: idNumber		ifNone: [ self fail ].	self		assert: customer		isNamed: 'Pepe'		lastName: 'Sanchez'		identfiedAs: idType		withNumber: idNumber		andNumberOfAddresses: 2.	self		assert: customer		hasAddressAt: 'San Martin'		number: 3322		in: 'Olivos'		zipCode: 1636		province: 'BsAs'.	self		assert: customer		hasAddressAt: 'Maipu'		number: 888		in: 'Florida'		zipCode: 1122		province: 'Buenos Aires'! !!CustomerImportTest methodsFor: 'asserting' stamp: 'RodrigoOscarKapobel 11/20/2017 14:22'!assert: customer hasAddressAt: streetName number: streetNumber in: town zipCode: zipCode province: province	| address |		address := customer addressAt: streetName ifNone: [ self fail ].	self assert: address streetName equals: streetName.	self assert: address streetNumber equals: streetNumber.	self assert: address town equals: town.	self assert: address zipCode equals: zipCode.	self assert: address province equals: province.	! !!CustomerImportTest methodsFor: 'asserting' stamp: 'RodrigoOscarKapobel 11/20/2017 14:22'!assertJuanPerezWasImportedCorrectly	| customer idType idNumber |	idType := 'C'.	idNumber := '23-25666777-9'.	customer := system		customerIdentifiedAs: idType		numbered: idNumber		ifNone: [ self fail ].	self		assert: customer		isNamed: 'Juan'		lastName: 'Perez'		identfiedAs: idType		withNumber: idNumber		andNumberOfAddresses: 1.	self		assert: customer		hasAddressAt: 'Alem'		number: 1122		in: 'CABA'		zipCode: 1001		province: 'CABA'! !!CustomerImportTest methodsFor: 'asserting' stamp: 'RodrigoOscarKapobel 11/20/2017 14:22'!assert: customer isNamed: firstName lastName: lastName identfiedAs: idType withNumber: idNumber andNumberOfAddresses: addressesSize	self assert: customer firstName equals: firstName.	self assert: customer lastName equals: lastName.	self assert: customer identificationType equals: idType.	self assert: customer identificationNumber equals: idNumber.	self assert: customer numberOfAddresses equals: addressesSize .! !!CustomerImportTest methodsFor: 'testing' stamp: 'alavia 11/23/2017 02:08'!testCanNotImportAddressRecordWithLessThanSixFields	self		should: [ self				importCustomersFrom: self addressRecordWithLessThanSixFieldsTestData.			self ]		raise: Error - MessageNotUnderstood		withExceptionDo: [ :anError | 			self				assert: anError messageText				equals: RecordImporter invalidRecordSizeErrorDescription.			self assert: self alwaysImportedCustomer addressesIsEmpty ]! !!CustomerImportTest methodsFor: 'testing' stamp: 'alavia 11/23/2017 01:49'!testShouldNotImportCustomerRecordsStartingWithMoreThanC	self		should: [ self				importCustomersFrom: self customerRecordStartingWithMoreThanOneCTestData.			self ]		raise: Error - MessageNotUnderstood		withExceptionDo: [ :anError | 			self				assert: anError messageText				equals: RecordImporter invalidRecordTypeErrorDescription.			self assert: system isCustomersEmpty ]! !!CustomerImportTest methodsFor: 'testing' stamp: 'alavia 11/23/2017 01:49'!testShouldNotImportAddressRecordsStartingWithMoreThanA	self		should: [ self				importCustomersFrom: self addressRecordStartingWithMoreThanOneATestData.			self ]		raise: Error - MessageNotUnderstood		withExceptionDo: [ :anError | 			self				assert: anError messageText				equals: RecordImporter invalidRecordTypeErrorDescription.			self assert: self alwaysImportedCustomer addressesIsEmpty ]! !!CustomerImportTest methodsFor: 'testing' stamp: 'alavia 11/23/2017 01:43'!testCanNotImportAddressWithoutCustomer	self		should: [ self importCustomersFrom: self addressWithoutCustomerTestData.			self ]		raise: Error - MessageNotUnderstood		withExceptionDo: [ :anError | 			self				assert: anError messageText				equals: AddressRecordImporter  addressWithoutDependencyErrorDescription.			self assert: system isCustomersEmpty ]! !!CustomerImportTest methodsFor: 'testing' stamp: 'alavia 11/23/2017 01:39'!testImportCustomers	self importCustomersFrom: self validTestData.	self assertImportedCustomersSizeIsCorrect.	self assertPepeSanchezWasImportedCorrectly.	self assertJuanPerezWasImportedCorrectly! !!CustomerImportTest methodsFor: 'testing' stamp: 'alavia 11/23/2017 02:08'!testCanNotImportCustomerRecordWithLessThanFiveFields	self		should: [ self				importCustomersFrom: self customerRecordWithLessThanFiveFieldsTestData.			self ]		raise: Error - MessageNotUnderstood		withExceptionDo: [ :anError | 			self				assert: anError messageText				equals: RecordImporter invalidRecordSizeErrorDescription.			self assert: system isCustomersEmpty ]! !!CustomerImportTest methodsFor: 'testing' stamp: 'alavia 11/23/2017 02:12'!testEmptyLinesAreRecognizedAsInvalidRecords	self		should: [ self importCustomersFrom: self dataWithEmptyLine.			self ]		raise: Error - MessageNotUnderstood		withExceptionDo: [ :anError | 			self				assert: anError messageText				equals: StreamImporter emptyRecordErrorDescription .			self assert: self alwaysImportedCustomer addressesIsEmpty ]! !!CustomerImportTest methodsFor: 'testing' stamp: 'alavia 11/23/2017 02:08'!testCanNotImportAddressRecordWithMoreThanSixFields	self		should: [ self				importCustomersFrom: self addressRecordWithMoreThanSixFieldsTestData.			self ]		raise: Error - MessageNotUnderstood		withExceptionDo: [ :anError | 			self				assert: anError messageText				equals: RecordImporter invalidRecordSizeErrorDescription.			self assert: self alwaysImportedCustomer addressesIsEmpty ]! !!CustomerImportTest methodsFor: 'testing' stamp: 'alavia 11/23/2017 02:08'!testCanNotImportCustomerRecordWithMoreThanFiveFields	self		should: [ self				importCustomersFrom: self customerRecordWithMoreThanFiveFieldsTestData.			self ]		raise: Error - MessageNotUnderstood		withExceptionDo: [ :anError | 			self				assert: anError messageText				equals: RecordImporter invalidRecordSizeErrorDescription.			self assert: system isCustomersEmpty ]! !!CustomerImportTest methodsFor: 'importing' stamp: 'alavia 11/23/2017 02:12'!importCustomersFrom: inputStream	(StreamImporter from: inputStream on: system ) import! !!CustomerImportTest methodsFor: 'setup-teardown' stamp: 'alavia 11/16/2017 20:45'!setUp	system := Environment current createCustomerSystem.	system start.	system beginTransaction! !!CustomerImportTest methodsFor: 'setup-teardown' stamp: 'RodrigoOscarKapobel 11/20/2017 11:25'!tearDown	system commit.	system close! !Object subclass: #Environment	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Environment class	instanceVariableNames: ''!!Environment class methodsFor: 'accessing' stamp: 'alavia 11/21/2017 23:12'!current	^self subclasses detect: [ :aEnvironmentClass | aEnvironmentClass isCurrent ].! !!Environment class methodsFor: 'actions' stamp: 'alavia 11/21/2017 23:12'!createSupplierSystem	self subclassResponsibility ! !!Environment class methodsFor: 'actions' stamp: 'RodrigoOscarKapobel 11/20/2017 12:09'!createCustomerSystem	self subclassResponsibility ! !!Environment class methodsFor: 'actions' stamp: 'alavia 11/23/2017 03:10'!createERPSystemWith: aCustomerSystem and: aSupplierSystem	^ERPSystem with: aCustomerSystem and: aSupplierSystem.! !!Environment class methodsFor: 'actions' stamp: 'alavia 11/23/2017 03:10'!createERPSystem	^self subclassResponsibility .! !!Environment class methodsFor: 'actions' stamp: 'RodrigoOscarKapobel 11/20/2017 12:05'!isCurrent	self subclassResponsibility! !Environment subclass: #DevelopmentEnvironment	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!DevelopmentEnvironment class	instanceVariableNames: ''!!DevelopmentEnvironment class methodsFor: 'actions' stamp: 'alavia 11/22/2017 05:30'!createERPSystem	^ERPSystem with: self createCustomerSystem and: self createSupplierSystem .! !!DevelopmentEnvironment class methodsFor: 'actions' stamp: 'alavia 11/23/2017 02:09'!isCurrent	^true.! !!DevelopmentEnvironment class methodsFor: 'actions' stamp: 'alavia 11/22/2017 04:56'!createSupplierSystem	^TransientSupplierSystem new.! !!DevelopmentEnvironment class methodsFor: 'actions' stamp: 'alavia 11/21/2017 23:13'!createCustomerSystem	^TransientCustomerSystem new.! !Environment subclass: #IntegrationEnvironment	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!IntegrationEnvironment class	instanceVariableNames: ''!!IntegrationEnvironment class methodsFor: 'actions' stamp: 'alavia 11/22/2017 05:30'!createERPSystem	^ERPSystem with: self createCustomerSystem and: self createSupplierSystem .! !!IntegrationEnvironment class methodsFor: 'actions' stamp: 'alavia 11/21/2017 23:13'!isCurrent	^DevelopmentEnvironment isCurrent not.! !!IntegrationEnvironment class methodsFor: 'actions' stamp: 'alavia 11/22/2017 04:56'!createSupplierSystem	^PersistentSupplierSystem new.	! !!IntegrationEnvironment class methodsFor: 'actions' stamp: 'alavia 11/21/2017 23:13'!createCustomerSystem	^PersistentCustomerSystem new.! !Object subclass: #Party	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!Party subclass: #Customer	instanceVariableNames: 'id firstName lastName identificationType identificationNumber addresses'	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!!Customer methodsFor: 'as yet unclassified' stamp: 'HernanWilkinson 11/1/2016 18:03'!addressesIsEmpty		^addresses isEmpty! !!Customer methodsFor: 'as yet unclassified' stamp: 'HernanWilkinson 11/1/2016 10:05'!addressAt: aStreetName ifNone: noneClosure 		^addresses detect: [ :anAddress | anAddress isAt: aStreetName ] ifNone: noneClosure ! !!Customer methodsFor: 'identification' stamp: 'HernanWilkinson 10/28/2016 16:13'!identificationNumber		^identificationNumber ! !!Customer methodsFor: 'identification' stamp: 'HernanWilkinson 10/28/2016 13:10'!identificationType: anIdentificationType 	identificationType := anIdentificationType! !!Customer methodsFor: 'identification' stamp: 'HernanWilkinson 10/28/2016 13:10'!identificationNumber: anIdentificationNumber 	identificationNumber := anIdentificationNumber! !!Customer methodsFor: 'identification' stamp: 'RodrigoOscarKapobel 11/20/2017 01:08'!isIdentifiedAs:anIdentificationType numbered:anIdentificationNumber	^identificationType = anIdentificationType and: 	[identificationNumber = anIdentificationNumber]! !!Customer methodsFor: 'identification' stamp: 'HernanWilkinson 10/28/2016 16:13'!identificationType		^identificationType ! !!Customer methodsFor: 'addresses' stamp: 'HernanWilkinson 11/1/2016 09:43'!numberOfAddresses		^addresses size! !!Customer methodsFor: 'addresses' stamp: 'HernanWilkinson 10/28/2016 13:25'!addresses	^ addresses! !!Customer methodsFor: 'addresses' stamp: 'HernanWilkinson 10/28/2016 13:27'!addAddress: anAddress 	addresses add: anAddress ! !!Customer methodsFor: 'initialization' stamp: 'HernanWilkinson 10/28/2016 13:26'!initialize	super initialize.	addresses := OrderedCollection new.! !!Customer methodsFor: 'name' stamp: 'HernanWilkinson 10/28/2016 16:15'!lastName	^lastName ! !!Customer methodsFor: 'name' stamp: 'HernanWilkinson 10/28/2016 13:09'!lastName: aLastName 	lastName := aLastName! !!Customer methodsFor: 'name' stamp: 'HernanWilkinson 10/28/2016 16:15'!firstName		^firstName ! !!Customer methodsFor: 'name' stamp: 'HernanWilkinson 10/28/2016 13:09'!firstName: aName 	firstName := aName! !Object subclass: #RecordImporter	instanceVariableNames: 'system importer record'	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!!RecordImporter methodsFor: 'asserting' stamp: 'alavia 11/23/2017 02:03'!assertValidRecordSize		record size ~= self size ifTrue: [ self signalInvalidRecordSize ].! !!RecordImporter methodsFor: 'asserting' stamp: 'alavia 11/23/2017 02:06'!signalInvalidRecordSize		self error: self class invalidRecordSizeErrorDescription ! !!RecordImporter methodsFor: 'importing' stamp: 'alavia 11/23/2017 01:21'!import	^self subclassResponsibility .! !!RecordImporter methodsFor: 'initialization' stamp: 'alavia 11/23/2017 01:51'!initializeWith: aRecord on: aSystem with: aImporter 	record := aRecord .	system := aSystem .	importer := aImporter .! !!RecordImporter methodsFor: 'accessing' stamp: 'alavia 11/22/2017 23:43'!size	^self subclassResponsibility .! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!RecordImporter class	instanceVariableNames: ''!!RecordImporter class methodsFor: 'instance creation' stamp: 'alavia 11/23/2017 01:53'!for: aRecord on: aSystem with: aImporter	self allSubclasses detect: [ :aRecordImporterClass | aRecordImporterClass canImport: aRecord ] 	ifFound: [ :aRecordImporterClass | ^aRecordImporterClass new initializeWith: aRecord on: aSystem with: aImporter. ]	ifNone: [ self error: self invalidRecordTypeErrorDescription ]! !!RecordImporter class methodsFor: 'instance creation' stamp: 'alavia 11/23/2017 00:34'!canImport: aRecord	^self subclassResponsibility .! !!RecordImporter class methodsFor: 'error descriptions' stamp: 'alavia 11/23/2017 00:32'!invalidRecordTypeErrorDescription		^'Invalid record type'! !!RecordImporter class methodsFor: 'error descriptions' stamp: 'alavia 11/23/2017 02:06'!invalidRecordSizeErrorDescription		^'Invalid record size'! !RecordImporter subclass: #AddressRecordImporter	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!!AddressRecordImporter methodsFor: 'signalling' stamp: 'alavia 11/23/2017 01:33'!signalAddressWithoutDependencyError	self error: self class addressWithoutDependencyErrorDescription.! !!AddressRecordImporter methodsFor: 'importing' stamp: 'alavia 11/23/2017 02:35'!import	| newAddress |		self assertValidRecordSize.	self assertThereIsDependencyForAddress.		newAddress := Address new.	newAddress streetName: record second.	newAddress streetNumber: record third asInteger.	newAddress town: record fourth.	newAddress zipCode: record fifth asInteger.	newAddress province: record sixth.		^importer dependant addAddress: newAddress! !!AddressRecordImporter methodsFor: 'asserting' stamp: 'alavia 11/23/2017 01:29'!size	^6! !!AddressRecordImporter methodsFor: 'asserting' stamp: 'alavia 11/23/2017 01:32'!assertThereIsDependencyForAddress	importer dependant isNil ifTrue: [ self signalAddressWithoutDependencyError ].	! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!AddressRecordImporter class	instanceVariableNames: ''!!AddressRecordImporter class methodsFor: 'instance creation' stamp: 'alavia 11/23/2017 01:35'!addressWithoutDependencyErrorDescription	^'Address without dependency error'.! !!AddressRecordImporter class methodsFor: 'instance creation' stamp: 'alavia 11/23/2017 01:42'!canImport: aRecord	^aRecord first = 'A'.! !RecordImporter subclass: #CustomerRecordImporter	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!!CustomerRecordImporter methodsFor: 'importing' stamp: 'alavia 11/23/2017 02:36'!import	| newCustomer |		self assertValidRecordSize.		newCustomer := Customer new.	newCustomer firstName: record second.	newCustomer lastName: record third.	newCustomer identificationType: record fourth.	newCustomer identificationNumber: record fifth.		importer dependant: newCustomer.	system addCustomer: newCustomer.! !!CustomerRecordImporter methodsFor: 'asserting' stamp: 'alavia 11/23/2017 01:24'!size	^5! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!CustomerRecordImporter class	instanceVariableNames: ''!!CustomerRecordImporter class methodsFor: 'error descriptions' stamp: 'alavia 11/23/2017 01:42'!canImport: aRecord	^aRecord first = 'C'.! !RecordImporter subclass: #ExistingCustomerRecordImporter	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!!ExistingCustomerRecordImporter methodsFor: 'asserting' stamp: 'alavia 11/23/2017 02:50'!size	^3! !!ExistingCustomerRecordImporter methodsFor: 'importing' stamp: 'alavia 11/23/2017 02:47'!import	| existingCustomer |		self assertValidRecordSize.	"falta error dependencia nil"	existingCustomer := system customerIdentifiedAs: record second numbered: record third ifNone: [ self signalExistingCustomerNotPersisted ].	importer dependant addCustomer: existingCustomer! !!ExistingCustomerRecordImporter methodsFor: 'signalling' stamp: 'alavia 11/23/2017 03:36'!signalExistingCustomerNotPersisted 		self error: self class existingCustomerNotPersistedErrorDescription ! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!ExistingCustomerRecordImporter class	instanceVariableNames: ''!!ExistingCustomerRecordImporter class methodsFor: 'error descriptions' stamp: 'alavia 11/23/2017 03:36'!existingCustomerNotPersistedErrorDescription	^'Trying to add an existing customer not persisted before'! !!ExistingCustomerRecordImporter class methodsFor: 'error descriptions' stamp: 'alavia 11/23/2017 02:45'!canImport: aRecord	^aRecord first = 'EC'.! !RecordImporter subclass: #NewCustomerRecordImporter	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!!NewCustomerRecordImporter methodsFor: 'importing' stamp: 'alavia 11/23/2017 02:41'!import	| newCustomer |		self assertValidRecordSize.	"falta error dependencia nil"	newCustomer := Customer new.	newCustomer firstName: record second.	newCustomer lastName: record third.	newCustomer identificationType: record fourth.	newCustomer identificationNumber: record fifth.		system addCustomer: newCustomer.	importer dependant addCustomer: newCustomer! !!NewCustomerRecordImporter methodsFor: 'asserting' stamp: 'alavia 11/23/2017 02:39'!size	^5! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!NewCustomerRecordImporter class	instanceVariableNames: ''!!NewCustomerRecordImporter class methodsFor: 'error descriptions' stamp: 'alavia 11/23/2017 02:39'!canImport: aRecord	^aRecord first = 'NC'.! !Object subclass: #StreamImporter	instanceVariableNames: 'line readStream record newCustomer system dependant'	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!!StreamImporter methodsFor: 'importing' stamp: 'alavia 11/23/2017 00:09'!import	[ self canImportNextLine ] whileTrue: [ 		self convertLineToRecord.		self importRecord ]! !!StreamImporter methodsFor: 'importing - private' stamp: 'alavia 11/23/2017 00:09'!convertLineToRecord	record := line substrings: {$,}.		self assertRecordNotEmpty! !!StreamImporter methodsFor: 'importing - private' stamp: 'alavia 11/23/2017 00:33'!assertRecordNotEmpty		record isEmpty ifTrue: [ self error: self class emptyRecordErrorDescription ]! !!StreamImporter methodsFor: 'importing - private' stamp: 'alavia 11/23/2017 00:09'!canImportNextLine	line := readStream nextLine.	^ line notNil! !!StreamImporter methodsFor: 'importing - private' stamp: 'alavia 11/23/2017 01:13'!importRecord	| recordImporter |	recordImporter := RecordImporter for: record on: system with: self.	recordImporter import.! !!StreamImporter methodsFor: 'accessing' stamp: 'alavia 11/23/2017 01:18'!dependant: anObject	dependant := anObject .! !!StreamImporter methodsFor: 'accessing' stamp: 'alavia 11/23/2017 01:18'!dependant	^dependant.! !!StreamImporter methodsFor: 'initialization' stamp: 'alavia 11/23/2017 00:09'!initializeOn: aReadStream on: aSystem	readStream := aReadStream.	system := aSystem.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!StreamImporter class	instanceVariableNames: ''!!StreamImporter class methodsFor: 'instance creation' stamp: 'alavia 11/23/2017 00:09'!from: aReadStream on: aSystem	^self new initializeOn: aReadStream on: aSystem! !!StreamImporter class methodsFor: 'error descriptions' stamp: 'alavia 11/23/2017 00:09'!invalidCustomerRecordErrorDescription		^'Invalid customer record'! !!StreamImporter class methodsFor: 'error descriptions' stamp: 'alavia 11/23/2017 00:09'!addressWithoutCustomerErrorDescription		^'There is no Customer for the imported address'! !!StreamImporter class methodsFor: 'error descriptions' stamp: 'alavia 11/23/2017 00:34'!emptyRecordErrorDescription		^'Empty record error'! !!StreamImporter class methodsFor: 'error descriptions' stamp: 'alavia 11/23/2017 00:09'!invalidAddressRecordErrorDescription		^'Invalid address record'! !Party subclass: #Supplier	instanceVariableNames: 'id name identificationType identificationNumber addresses customers'	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!!Supplier methodsFor: 'addresses' stamp: 'RodrigoOscarKapobel 11/20/2017 13:28'!addressesIsEmpty		^addresses isEmpty! !!Supplier methodsFor: 'addresses' stamp: 'RodrigoOscarKapobel 11/20/2017 13:28'!numberOfAddresses		^addresses size! !!Supplier methodsFor: 'addresses' stamp: 'RodrigoOscarKapobel 11/20/2017 13:28'!addresses	^ addresses! !!Supplier methodsFor: 'addresses' stamp: 'RodrigoOscarKapobel 11/20/2017 13:28'!addAddress: anAddress 	addresses add: anAddress ! !!Supplier methodsFor: 'identification' stamp: 'RodrigoOscarKapobel 11/20/2017 13:28'!identificationNumber		^identificationNumber ! !!Supplier methodsFor: 'identification' stamp: 'alavia 11/23/2017 03:51'!identificationType: anIdentificationType 	identificationType := anIdentificationType! !!Supplier methodsFor: 'identification' stamp: 'RodrigoOscarKapobel 11/20/2017 13:28'!identificationNumber: anIdentificationNumber 	identificationNumber := anIdentificationNumber! !!Supplier methodsFor: 'identification' stamp: 'RodrigoOscarKapobel 11/20/2017 13:28'!isIdentifiedAs:anIdentificationType numbered:anIdentificationNumber	^identificationType = anIdentificationType and: 	[identificationNumber = anIdentificationNumber]! !!Supplier methodsFor: 'identification' stamp: 'RodrigoOscarKapobel 11/20/2017 13:28'!identificationType		^identificationType ! !!Supplier methodsFor: 'name' stamp: 'alavia 11/21/2017 23:46'!name		^name ! !!Supplier methodsFor: 'name' stamp: 'alavia 11/21/2017 23:46'!name: aName 	name := aName! !!Supplier methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 18:35'!customerWithIdType: anIdType andIdNumber: anIdNumber ifNone: noneClosure 		^customers detect: [ :aCustomer | aCustomer isIdentifiedAs: anIdType numbered: anIdNumber ] ifNone: noneClosure ! !!Supplier methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 17:07'!addressAt: aStreetName ifNone: noneClosure 		^addresses detect: [ :anAddress | anAddress isAt: aStreetName ] ifNone: noneClosure ! !!Supplier methodsFor: 'initialization' stamp: 'RodrigoOscarKapobel 11/20/2017 17:21'!initialize	super initialize.	addresses := OrderedCollection new.	customers := OrderedCollection new.! !!Supplier methodsFor: 'customers' stamp: 'RodrigoOscarKapobel 11/20/2017 17:07'!customers	^ customers! !!Supplier methodsFor: 'customers' stamp: 'RodrigoOscarKapobel 11/20/2017 17:08'!customersIsEmpty		^customers isEmpty! !!Supplier methodsFor: 'customers' stamp: 'RodrigoOscarKapobel 11/20/2017 17:07'!addCustomer: aCustomer 	customers add: aCustomer ! !!Supplier methodsFor: 'customers' stamp: 'RodrigoOscarKapobel 11/20/2017 17:09'!numberOfCustomers		^customers size! !TestCase subclass: #SupplierImportTest	instanceVariableNames: 'supplierSystem customerSystem erpSystem'	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!!SupplierImportTest methodsFor: 'setup-teardown' stamp: 'alavia 11/23/2017 03:12'!setUp		supplierSystem := Environment current createSupplierSystem.		customerSystem := Environment current createCustomerSystem .	erpSystem := Environment current createERPSystemWith: customerSystem and: supplierSystem.	erpSystem start.	erpSystem beginTransaction.! !!SupplierImportTest methodsFor: 'setup-teardown' stamp: 'alavia 11/23/2017 03:12'!tearDown	erpSystem commit.	erpSystem close.! !!SupplierImportTest methodsFor: 'test data - supplier' stamp: 'RodrigoOscarKapobel 11/20/2017 15:20'!supplierRecordStartingWithMoreThanOneSTestData		^ ReadStream on:'SS,Pepe,D,22333444'! !!SupplierImportTest methodsFor: 'test data - supplier' stamp: 'alavia 11/22/2017 21:08'!alwaysImportedSupplier	^ supplierSystem		supplierIdentifiedAs: self alwaysImportedCustomerIdType		numbered: self alwaysImportedCustomerIdNumber		ifNone: [ self fail ]! !!SupplierImportTest methodsFor: 'test data - supplier' stamp: 'alavia 11/21/2017 22:41'!alwaysImportedSupplierRecord	^ 'S,Supplier1,', self alwaysImportedCustomerIdType, ',', self alwaysImportedCustomerIdNumber ! !!SupplierImportTest methodsFor: 'test data - supplier' stamp: 'RodrigoOscarKapobel 11/20/2017 15:44'!supplierRecordWithLessThanFourFieldsTestData		^ ReadStream on: 'S,Pepe,D'! !!SupplierImportTest methodsFor: 'test data - supplier' stamp: 'RodrigoOscarKapobel 11/20/2017 15:37'!supplierRecordWithMoreThanFourFieldsTestData		^ ReadStream on: self alwaysImportedSupplierRecord,',x'! !!SupplierImportTest methodsFor: 'test data - address' stamp: 'RodrigoOscarKapobel 11/20/2017 16:07'!addressRecordWithMoreThanSixFieldsTestData		^ ReadStream on: self alwaysImportedSupplierRecord,'A,San Martin,3322,Olivos,1636,BsAs,y otra cosa'! !!SupplierImportTest methodsFor: 'test data - address' stamp: 'RodrigoOscarKapobel 11/20/2017 14:51'!addressWithoutCustomerTestData		^ ReadStream on: 'A,San Martin,3322,Olivos,1636,BsAs'! !!SupplierImportTest methodsFor: 'test data - address' stamp: 'RodrigoOscarKapobel 11/20/2017 16:04'!addressRecordWithLessThanSixFieldsTestData		^ ReadStream on: self alwaysImportedSupplierRecord,'A,San Martin,3322,Olivos,1636'! !!SupplierImportTest methodsFor: 'test data - address' stamp: 'RodrigoOscarKapobel 11/20/2017 16:02'!addressRecordStartingWithMoreThanOneATestData		^ ReadStream on: self alwaysImportedSupplierRecord,'AA,San Martin,3322,Olivos,1636,BsAs'! !!SupplierImportTest methodsFor: 'importing' stamp: 'alavia 11/23/2017 03:06'!importCustomersFrom: inputStream	(StreamImporter from: inputStream on: customerSystem ) import! !!SupplierImportTest methodsFor: 'importing' stamp: 'alavia 11/23/2017 03:06'!importSuppliersFrom: inputStream	(StreamImporter from: inputStream on: erpSystem ) import! !!SupplierImportTest methodsFor: 'asserting' stamp: 'RodrigoOscarKapobel 11/20/2017 14:30'!assert: aSupplier hasAddressAt: streetName number: streetNumber in: town zipCode: zipCode province: province 	| address |		address := aSupplier  addressAt: streetName ifNone: [ self fail ].	self assert: address streetName equals: streetName.	self assert: address streetNumber equals: streetNumber.	self assert: address town equals: town.	self assert: address zipCode equals: zipCode.	self assert: address province equals: province.! !!SupplierImportTest methodsFor: 'asserting' stamp: 'alavia 11/22/2017 21:08'!assertPepeSanchezSupplierWithNewCustomersWasImportedCorrectly	| supplier idType idNumber |	idType := 'D'.	idNumber := '22333444'.	supplier := supplierSystem		supplierIdentifiedAs: idType		numbered: idNumber		ifNone: [ self fail ].	self		assert: supplier		isNamed: 'Supplier1'		identfiedAs: idType		withNumber: idNumber		numberOfCustomers: 1		andNumberOfAddresses: 2.	self		assert: supplier		hasCustomerWithFirstName: 'Pepe'		lastName: 'Sanchez'		idType: idType		idNumber: idNumber.	self		assert: supplier		hasAddressAt: 'San Martin'		number: 3322		in: 'Olivos'		zipCode: 1636		province: 'BsAs'.	self		assert: supplier		hasAddressAt: 'Maipu'		number: 888		in: 'Florida'		zipCode: 1122		province: 'Buenos Aires'! !!SupplierImportTest methodsFor: 'asserting' stamp: 'alavia 11/22/2017 22:20'!assertSupplier1WithExistingCustomersWasImportedCorrectly	| supplier idType idNumber |	idType := 'D'.	idNumber := '22333444'.	supplier := supplierSystem		supplierIdentifiedAs: idType		numbered: idNumber		ifNone: [ self fail ].	self		assert: supplier		isNamed: 'Supplier1'		identfiedAs: idType		withNumber: idNumber		numberOfCustomers: 1		andNumberOfAddresses: 2.	self		assert: supplier		hasCustomerWithFirstName: 'Juan'		lastName: 'Perez'		idType: 'D'		idNumber: '5456774'.	self		assert: supplier		hasAddressAt: 'San Martin'		number: 3322		in: 'Olivos'		zipCode: 1636		province: 'BsAs'.	self		assert: supplier		hasAddressAt: 'Maipu'		number: 888		in: 'Florida'		zipCode: 1122		province: 'Buenos Aires'! !!SupplierImportTest methodsFor: 'asserting' stamp: 'alavia 11/22/2017 21:08'!assertImportedSuppliersSizeIsCorrect	self assert: supplierSystem allSuppliersSize equals: 1! !!SupplierImportTest methodsFor: 'asserting' stamp: 'alavia 11/22/2017 21:08'!assertPepeSanchezSupplierWithoutCustomersWasImportedCorrectly	| supplier idType idNumber |	idType := 'D'.	idNumber := '22333444'.	supplier := supplierSystem		supplierIdentifiedAs: idType		numbered: idNumber		ifNone: [ self fail ].	self		assert: supplier		isNamed: 'Supplier1'		identfiedAs: idType		withNumber: idNumber		numberOfCustomers: 0		andNumberOfAddresses: 2.	self		assert: supplier		hasAddressAt: 'San Martin'		number: 3322		in: 'Olivos'		zipCode: 1636		province: 'BsAs'.	self		assert: supplier		hasAddressAt: 'Maipu'		number: 888		in: 'Florida'		zipCode: 1122		province: 'Buenos Aires'! !!SupplierImportTest methodsFor: 'asserting' stamp: 'alavia 11/21/2017 22:46'!assert: aSupplier isNamed: name identfiedAs: idType withNumber: idNumber numberOfCustomers: customersSize andNumberOfAddresses: addressesSize 	self assert: aSupplier name equals: name.	self assert: aSupplier identificationType equals: idType.	self assert: aSupplier identificationNumber equals: idNumber.	self assert: aSupplier numberOfCustomers equals: customersSize.	self assert: aSupplier numberOfAddresses equals: addressesSize.! !!SupplierImportTest methodsFor: 'asserting' stamp: 'alavia 11/21/2017 22:46'!assert: aSupplier hasCustomerWithFirstName: aFirstName lastName: aLastName idType: anIdType idNumber: anIdNumber 	| customer |		customer := aSupplier customerWithIdType: anIdType andIdNumber: anIdNumber ifNone: [ self fail ].	self assert: customer firstName equals: aFirstName.	self assert: customer lastName equals: aLastName.	self assert: customer identificationType equals: anIdType.	self assert: customer identificationNumber equals: anIdNumber.! !!SupplierImportTest methodsFor: 'testing' stamp: 'alavia 11/23/2017 03:42'!testShouldNotImportSupplierRecordsStartingWithMoreThanS	self		should: [ self				importSuppliersFrom: self supplierRecordStartingWithMoreThanOneSTestData.			self ]		raise: Error - MessageNotUnderstood		withExceptionDo: [ :anError | 			self				assert: anError messageText				equals: SupplierRecordImporter invalidRecordTypeErrorDescription.			self assert: supplierSystem isSuppliersEmpty ]! !!SupplierImportTest methodsFor: 'testing' stamp: 'alavia 11/22/2017 22:17'!testCanImportSuppliersWithExistingCustomers	self importCustomersFrom: self validTestDataOfCustomerRecord.	self importSuppliersFrom: self validTestDataWithExistingCustomers.		self assertImportedSuppliersSizeIsCorrect.	self assertSupplier1WithExistingCustomersWasImportedCorrectly .! !!SupplierImportTest methodsFor: 'testing' stamp: 'alavia 11/23/2017 03:41'!testCanNotImportSuppliersWithExistingCustomersNotPersistedBefore	self		should: [ self importSuppliersFrom: self validTestDataWithExistingCustomers.		self ]		raise: Error - MessageNotUnderstood		withExceptionDo: [ :anError | 			self				assert: anError messageText				equals: ExistingCustomerRecordImporter existingCustomerNotPersistedErrorDescription.			self assert: self alwaysImportedSupplier addressesIsEmpty ]	! !!SupplierImportTest methodsFor: 'testing' stamp: 'alavia 11/22/2017 05:31'!testCanImportSuppliersWithoutCustomers	self importSuppliersFrom: self validTestDataWithoutCustomers.		self assertImportedSuppliersSizeIsCorrect.	self assertPepeSanchezSupplierWithoutCustomersWasImportedCorrectly.	! !!SupplierImportTest methodsFor: 'testing' stamp: 'alavia 11/23/2017 03:40'!testCanNotImportSupplierRecordWithLessThanFourFields	self		should: [ self				importSuppliersFrom: self supplierRecordWithLessThanFourFieldsTestData.			self ]		raise: Error - MessageNotUnderstood		withExceptionDo: [ :anError | 			self				assert: anError messageText				equals: SupplierRecordImporter invalidRecordSizeErrorDescription.			self assert: supplierSystem isSuppliersEmpty ]! !!SupplierImportTest methodsFor: 'testing' stamp: 'alavia 11/23/2017 03:40'!testCanNotImportAddressWithoutSupplier	self		should: [ self importSuppliersFrom: self addressWithoutCustomerTestData.			self ]		raise: Error - MessageNotUnderstood		withExceptionDo: [ :anError | 			self				assert: anError messageText				equals: AddressRecordImporter  addressWithoutDependencyErrorDescription.			self assert: supplierSystem isSuppliersEmpty ]! !!SupplierImportTest methodsFor: 'testing' stamp: 'alavia 11/22/2017 21:21'!testCanImportSuppliersWithNewCustomers	self importSuppliersFrom: self validTestDataWithNewCustomers.		self assertImportedSuppliersSizeIsCorrect.	self assertPepeSanchezSupplierWithNewCustomersWasImportedCorrectly.	self assert: (customerSystem allCustomersSize) equals: 1! !!SupplierImportTest methodsFor: 'testing' stamp: 'alavia 11/23/2017 03:40'!testCanNotImportSupplierRecordWithMoreThanFourFields	self		should: [ self				importSuppliersFrom: self supplierRecordWithMoreThanFourFieldsTestData.			self ]		raise: Error - MessageNotUnderstood		withExceptionDo: [ :anError | 			self				assert: anError messageText				equals: SupplierRecordImporter invalidRecordSizeErrorDescription.			self assert: supplierSystem isSuppliersEmpty ]! !!SupplierImportTest methodsFor: 'test data - customer' stamp: 'RodrigoOscarKapobel 11/20/2017 14:09'!alwaysImportedCustomerIdType	^ 'D'! !!SupplierImportTest methodsFor: 'test data - customer' stamp: 'alavia 11/22/2017 22:07'!validTestDataOfCustomerRecord	^ReadStream on: 'C,Juan,Perez,D,5456774'! !!SupplierImportTest methodsFor: 'test data - customer' stamp: 'RodrigoOscarKapobel 11/20/2017 16:23'!alwaysImportedNewCustomerRecord	^ 'NC,Pepe,Sanchez,', self alwaysImportedCustomerIdType, ',', self alwaysImportedCustomerIdNumber ! !!SupplierImportTest methodsFor: 'test data - customer' stamp: 'alavia 11/22/2017 22:14'!alwaysImportedExistingCustomerRecord	^ 'EC,D,5456774'! !!SupplierImportTest methodsFor: 'test data - customer' stamp: 'RodrigoOscarKapobel 11/20/2017 14:09'!alwaysImportedCustomerIdNumber	^ '22333444'! !!SupplierImportTest methodsFor: 'test data' stamp: 'RodrigoOscarKapobel 11/20/2017 16:54'!validTestDataWithExistingCustomers	^ ReadStream on: self alwaysImportedSupplierRecord,'',self alwaysImportedExistingCustomerRecord,'A,San Martin,3322,Olivos,1636,BsAsA,Maipu,888,Florida,1122,Buenos Aires'! !!SupplierImportTest methodsFor: 'test data' stamp: 'RodrigoOscarKapobel 11/20/2017 14:48'!dataWithEmptyLine		^ ReadStream on: self alwaysImportedSupplierRecord,'A,San Martin,3322,Olivos,1636,BsAs'! !!SupplierImportTest methodsFor: 'test data' stamp: 'RodrigoOscarKapobel 11/20/2017 16:27'!validTestDataWithoutCustomers	^ ReadStream on: self alwaysImportedSupplierRecord,'A,San Martin,3322,Olivos,1636,BsAsA,Maipu,888,Florida,1122,Buenos Aires'! !!SupplierImportTest methodsFor: 'test data' stamp: 'RodrigoOscarKapobel 11/20/2017 16:53'!validTestDataWithNewCustomers	^ ReadStream on: self alwaysImportedSupplierRecord,'',self alwaysImportedNewCustomerRecord,'A,San Martin,3322,Olivos,1636,BsAsA,Maipu,888,Florida,1122,Buenos Aires'! !RecordImporter subclass: #SupplierRecordImporter	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!!SupplierRecordImporter methodsFor: 'importing' stamp: 'alavia 11/23/2017 02:48'!import	| newSupplier |		self assertValidRecordSize.		newSupplier := Supplier new.	newSupplier name: record second.	newSupplier identificationType: record third.	newSupplier identificationNumber: record fourth.		importer dependant: newSupplier.	system addSupplier: newSupplier.! !!SupplierRecordImporter methodsFor: 'asserting' stamp: 'alavia 11/23/2017 02:50'!size	^4! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!SupplierRecordImporter class	instanceVariableNames: ''!!SupplierRecordImporter class methodsFor: 'error descriptions' stamp: 'alavia 11/23/2017 02:54'!canImport: aRecord	^aRecord first = 'S'.! !Object subclass: #System	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!System subclass: #CustomerSystem	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!!CustomerSystem methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 22:20'!allCustomers	^ self subclassResponsibility! !!CustomerSystem methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 22:20'!allCustomersSize	^ self subclassResponsibility! !!CustomerSystem methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 22:20'!close	^ self subclassResponsibility! !!CustomerSystem methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 22:20'!commit	^ self subclassResponsibility! !!CustomerSystem methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 22:20'!start	^ self subclassResponsibility! !!CustomerSystem methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 22:20'!isCustomersEmpty	^ self subclassResponsibility! !!CustomerSystem methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 22:20'!beginTransaction	^ self subclassResponsibility! !!CustomerSystem methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 22:20'!customerIdentifiedAs: arg1 numbered: arg2 ifNone: arg3 	^ self subclassResponsibility! !!CustomerSystem methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 22:20'!addCustomer: arg1 	^ self subclassResponsibility! !System subclass: #ERPSystem	instanceVariableNames: 'customerSystem supplierSystem'	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!!ERPSystem methodsFor: 'accessing' stamp: 'alavia 11/22/2017 04:45'!beginTransaction	customerSystem beginTransaction .	supplierSystem beginTransaction .! !!ERPSystem methodsFor: 'accessing' stamp: 'alavia 11/22/2017 04:45'!close	customerSystem close .	supplierSystem close .! !!ERPSystem methodsFor: 'accessing' stamp: 'alavia 11/22/2017 04:46'!start	customerSystem start .	supplierSystem start .! !!ERPSystem methodsFor: 'accessing' stamp: 'alavia 11/22/2017 04:45'!commit	customerSystem commit .	supplierSystem commit .! !!ERPSystem methodsFor: 'identification' stamp: 'alavia 11/23/2017 03:46'!identificationType: anIdentificationType 	identificationType := anIdentificationType! !!ERPSystem methodsFor: 'accesing' stamp: 'alavia 11/22/2017 05:39'!customerIdentifiedAs: aString numbered: aString2 ifNone: aBlockClosure 	^customerSystem customerIdentifiedAs: aString numbered: aString2 ifNone: aBlockClosure ! !!ERPSystem methodsFor: 'accesing' stamp: 'alavia 11/22/2017 05:37'!supplierIdentifiedAs: aString numbered: aString2 ifNone: aBlockClosure 	^supplierSystem supplierIdentifiedAs: aString numbered: aString2 ifNone: aBlockClosure ! !!ERPSystem methodsFor: 'asserting' stamp: 'alavia 11/22/2017 05:37'!allSuppliersSize	^supplierSystem allSuppliersSize .! !!ERPSystem methodsFor: 'initialization' stamp: 'alavia 11/22/2017 04:26'!initializeWith: aCustomerSystem and: aSupplierSystem	super initialize .	customerSystem := aCustomerSystem .	supplierSystem := aSupplierSystem .! !!ERPSystem methodsFor: 'adding' stamp: 'alavia 11/22/2017 04:44'!addSupplier: aSupplier	supplierSystem addSupplier: aSupplier .! !!ERPSystem methodsFor: 'adding' stamp: 'alavia 11/22/2017 04:43'!addCustomer: aCustomer	customerSystem addCustomer: aCustomer.! !!ERPSystem methodsFor: 'testing' stamp: 'alavia 11/22/2017 05:38'!isSuppliersEmpty	^supplierSystem isSuppliersEmpty .! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!ERPSystem class	instanceVariableNames: ''!!ERPSystem class methodsFor: 'as yet unclassified' stamp: 'alavia 11/22/2017 04:25'!with: aCustomerSystem and: aSupplierSystem	^self new initializeWith: aCustomerSystem and: aSupplierSystem .! !CustomerSystem subclass: #PersistentCustomerSystem	instanceVariableNames: 'session'	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!!PersistentCustomerSystem methodsFor: 'accesing' stamp: 'alavia 11/16/2017 20:04'!customerIdentifiedAs: anIdentifycationType numbered: anIdentificationNumber ifNone: noneBlock	| customers |	customers := session		select: [ :aCustomer | 			aCustomer identificationType = anIdentifycationType				and: [ aCustomer identificationNumber = anIdentificationNumber ] ]		ofType: Customer.	customers size = 1		ifTrue: [ ^ customers anyOne ]		ifFalse: noneBlock.	^ self! !!PersistentCustomerSystem methodsFor: 'initialization' stamp: 'alavia 11/13/2017 20:59'!initialize	super initialize.	self initializeSession.! !!PersistentCustomerSystem methodsFor: 'setup-teardown' stamp: 'alavia 11/16/2017 20:04'!close	session close! !!PersistentCustomerSystem methodsFor: 'setup-teardown' stamp: 'alavia 11/13/2017 20:56'!customerMapping	^ ClassMapping		withDefaultTableNameFor: Customer		mappingAll:			(Array				with: (EmbededMapping withDefaultFieldNameFor: #firstName)				with: (EmbededMapping withDefaultFieldNameFor: #lastName)				with: (EmbededMapping withDefaultFieldNameFor: #identificationType)				with: (EmbededMapping withDefaultFieldNameFor: #identificationNumber)				with: (OneToManyMapping withDefaultFieldNameFor: #addresses ofType: Address))! !!PersistentCustomerSystem methodsFor: 'setup-teardown' stamp: 'alavia 11/16/2017 20:04'!beginTransaction	session beginTransaction! !!PersistentCustomerSystem methodsFor: 'setup-teardown' stamp: 'alavia 11/16/2017 20:31'!start	session open! !!PersistentCustomerSystem methodsFor: 'setup-teardown' stamp: 'alavia 11/16/2017 20:04'!commit	session commit! !!PersistentCustomerSystem methodsFor: 'setup-teardown' stamp: 'RodrigoOscarKapobel 11/20/2017 11:51'!initializeSession	session := DataBaseSession		for: (Array with: self addressMapping with: self customerMapping)! !!PersistentCustomerSystem methodsFor: 'setup-teardown' stamp: 'alavia 11/13/2017 20:54'!addressMapping	^ ClassMapping		withDefaultTableNameFor: Address		mappingAll:			(Array				with: (EmbededMapping withDefaultFieldNameFor: #streetName)				with: (EmbededMapping withDefaultFieldNameFor: #streetNumber)				with: (EmbededMapping withDefaultFieldNameFor: #town)				with: (EmbededMapping withDefaultFieldNameFor: #zipCode)				with: (EmbededMapping withDefaultFieldNameFor: #province))! !!PersistentCustomerSystem methodsFor: 'customers' stamp: 'alavia 11/16/2017 20:04'!allCustomers	^ session selectAllOfType: Customer! !!PersistentCustomerSystem methodsFor: 'asserting' stamp: 'RodrigoOscarKapobel 11/20/2017 00:22'!allCustomersSize	^ self allCustomers size! !!PersistentCustomerSystem methodsFor: 'testing' stamp: 'RodrigoOscarKapobel 11/20/2017 01:12'!isCustomersEmpty	^ self allCustomers isEmpty! !!PersistentCustomerSystem methodsFor: 'persistance' stamp: 'RodrigoOscarKapobel 11/20/2017 00:42'!addCustomer: aCustomer	session persist: aCustomer .! !System subclass: #SupplierSystem	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!!SupplierSystem methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 22:21'!commit	^ self subclassResponsibility! !!SupplierSystem methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 22:21'!allSuppliers	^ self subclassResponsibility! !!SupplierSystem methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 22:21'!close	^ self subclassResponsibility! !!SupplierSystem methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 22:21'!supplierIdentifiedAs: arg1 numbered: arg2 ifNone: arg3 	^ self subclassResponsibility! !!SupplierSystem methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 22:21'!start	^ self subclassResponsibility! !!SupplierSystem methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 22:21'!allSuppliersSize	^ self subclassResponsibility! !!SupplierSystem methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 22:22'!isSuppliersEmpty	^ self subclassResponsibility! !!SupplierSystem methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 22:22'!beginTransaction	^ self subclassResponsibility! !!SupplierSystem methodsFor: 'accessing' stamp: 'RodrigoOscarKapobel 11/20/2017 22:21'!addSupplier: arg1 	^ self subclassResponsibility! !SupplierSystem subclass: #PersistentSupplierSystem	instanceVariableNames: 'session'	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!!PersistentSupplierSystem methodsFor: 'initialization' stamp: 'alavia 11/22/2017 04:48'!initialize	super initialize.	self initializeSession.! !!PersistentSupplierSystem methodsFor: 'asserting' stamp: 'RodrigoOscarKapobel 11/20/2017 14:10'!allSuppliersSize	^ self allSuppliers size! !!PersistentSupplierSystem methodsFor: 'setup-teardown' stamp: 'RodrigoOscarKapobel 11/20/2017 12:28'!close	session close! !!PersistentSupplierSystem methodsFor: 'setup-teardown' stamp: 'RodrigoOscarKapobel 11/20/2017 12:28'!beginTransaction	session beginTransaction! !!PersistentSupplierSystem methodsFor: 'setup-teardown' stamp: 'RodrigoOscarKapobel 11/20/2017 12:28'!commit	session commit! !!PersistentSupplierSystem methodsFor: 'setup-teardown' stamp: 'RodrigoOscarKapobel 11/20/2017 12:28'!start	session open! !!PersistentSupplierSystem methodsFor: 'setup-teardown' stamp: 'alavia 11/21/2017 23:40'!initializeSession	session := DataBaseSession		for: (Array with: self addressMapping with: self supplierMapping)! !!PersistentSupplierSystem methodsFor: 'setup-teardown' stamp: 'alavia 11/21/2017 22:34'!supplierMapping	^ ClassMapping		withDefaultTableNameFor: Supplier		mappingAll:			(Array				with: (EmbededMapping withDefaultFieldNameFor: #name)				with: (EmbededMapping withDefaultFieldNameFor: #identificationType)				with: (EmbededMapping withDefaultFieldNameFor: #identificationNumber)				with: (OneToManyMapping withDefaultFieldNameFor: #addresses ofType: Address))! !!PersistentSupplierSystem methodsFor: 'setup-teardown' stamp: 'RodrigoOscarKapobel 11/20/2017 12:28'!addressMapping	^ ClassMapping		withDefaultTableNameFor: Address		mappingAll:			(Array				with: (EmbededMapping withDefaultFieldNameFor: #streetName)				with: (EmbededMapping withDefaultFieldNameFor: #streetNumber)				with: (EmbededMapping withDefaultFieldNameFor: #town)				with: (EmbededMapping withDefaultFieldNameFor: #zipCode)				with: (EmbededMapping withDefaultFieldNameFor: #province))! !!PersistentSupplierSystem methodsFor: 'accesing' stamp: 'RodrigoOscarKapobel 11/20/2017 14:17'!supplierIdentifiedAs: anIdentifycationType numbered: anIdentificationNumber ifNone: noneBlock	| suppliers |	suppliers := session		select: [ :aSupplier | 			aSupplier identificationType = anIdentifycationType				and: [ aSupplier identificationNumber = anIdentificationNumber ] ]		ofType: Supplier.	suppliers size = 1		ifTrue: [ ^ suppliers anyOne ]		ifFalse: noneBlock.	^ self! !!PersistentSupplierSystem methodsFor: 'customers' stamp: 'RodrigoOscarKapobel 11/20/2017 14:06'!allSuppliers	^ session selectAllOfType: Supplier! !!PersistentSupplierSystem methodsFor: 'testing' stamp: 'RodrigoOscarKapobel 11/20/2017 15:24'!isSuppliersEmpty	^ self allSuppliers isEmpty! !!PersistentSupplierSystem methodsFor: 'persistance' stamp: 'RodrigoOscarKapobel 11/20/2017 19:57'!addSupplier: aSupplier	session persist: aSupplier.! !CustomerSystem subclass: #TransientCustomerSystem	instanceVariableNames: 'customers'	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!!TransientCustomerSystem methodsFor: 'initialization' stamp: 'alavia 11/16/2017 20:38'!initialize	super initialize.	customers := OrderedCollection new.! !!TransientCustomerSystem methodsFor: 'asserting' stamp: 'RodrigoOscarKapobel 11/20/2017 19:46'!allCustomersSize	^ customers size! !!TransientCustomerSystem methodsFor: 'testing' stamp: 'RodrigoOscarKapobel 11/20/2017 19:43'!isCustomersEmpty	^ customers isEmpty! !!TransientCustomerSystem methodsFor: 'persistance' stamp: 'RodrigoOscarKapobel 11/20/2017 00:40'!addCustomer: aCustomer	customers add: aCustomer .! !!TransientCustomerSystem methodsFor: 'setup-teardown' stamp: 'alavia 11/16/2017 20:44'!beginTransaction! !!TransientCustomerSystem methodsFor: 'setup-teardown' stamp: 'alavia 11/16/2017 20:39'!start! !!TransientCustomerSystem methodsFor: 'setup-teardown' stamp: 'alavia 11/16/2017 20:45'!close! !!TransientCustomerSystem methodsFor: 'setup-teardown' stamp: 'alavia 11/16/2017 20:45'!commit! !!TransientCustomerSystem methodsFor: 'customers' stamp: 'alavia 11/16/2017 20:44'!allCustomers	^customers copy.! !!TransientCustomerSystem methodsFor: 'accesing' stamp: 'RodrigoOscarKapobel 11/20/2017 01:07'!customerIdentifiedAs: anIdentifycationType numbered: anIdentificationNumber ifNone: noneBlock	customers detect: [:aCustomer | (aCustomer isIdentifiedAs: anIdentifycationType  numbered: anIdentificationNumber)]	         ifFound: [:aCustomer | ^aCustomer ] 				 ifNone: noneBlock .! !SupplierSystem subclass: #TransientSupplierSystem	instanceVariableNames: 'suppliers'	classVariableNames: ''	poolDictionaries: ''	category: '10Pines-C17-2-Model'!!TransientSupplierSystem methodsFor: 'customers' stamp: 'RodrigoOscarKapobel 11/20/2017 19:45'!allSuppliers	^ suppliers copy! !!TransientSupplierSystem methodsFor: 'setup-teardown' stamp: 'RodrigoOscarKapobel 11/20/2017 19:49'!beginTransaction! !!TransientSupplierSystem methodsFor: 'setup-teardown' stamp: 'RodrigoOscarKapobel 11/20/2017 19:49'!close! !!TransientSupplierSystem methodsFor: 'setup-teardown' stamp: 'RodrigoOscarKapobel 11/20/2017 19:49'!start! !!TransientSupplierSystem methodsFor: 'setup-teardown' stamp: 'RodrigoOscarKapobel 11/20/2017 19:48'!commit! !!TransientSupplierSystem methodsFor: 'persistance' stamp: 'RodrigoOscarKapobel 11/20/2017 19:57'!addSupplier: aSupplier	suppliers add: aSupplier.! !!TransientSupplierSystem methodsFor: 'accesing' stamp: 'RodrigoOscarKapobel 11/20/2017 19:52'!supplierIdentifiedAs: anIdentifycationType numbered: anIdentificationNumber ifNone: noneBlock	suppliers detect: [:aSupplier | (aSupplier isIdentifiedAs: anIdentifycationType  numbered: anIdentificationNumber)]	         ifFound: [:aSupplier | ^aSupplier ] 				 ifNone: noneBlock .! !!TransientSupplierSystem methodsFor: 'initialization' stamp: 'alavia 11/22/2017 04:55'!initialize	super initialize.	suppliers := OrderedCollection new.! !!TransientSupplierSystem methodsFor: 'testing' stamp: 'RodrigoOscarKapobel 11/20/2017 19:44'!isSuppliersEmpty	^ suppliers isEmpty! !!TransientSupplierSystem methodsFor: 'asserting' stamp: 'RodrigoOscarKapobel 11/20/2017 19:46'!allSuppliersSize	^ suppliers size.! !